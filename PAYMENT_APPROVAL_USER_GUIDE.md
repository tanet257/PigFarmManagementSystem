# üìñ Payment Approval System - User Guide

## ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ (For Users)

### Pig Entry Payment Workflow

#### Step 1: Record Payment
1. Navigate to `/pigentryrecord` (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏°‡∏π‡πÄ‡∏Ç‡πâ‡∏≤)
2. Find a Pig Entry Record
3. Click Payment Button (üí∞ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô)
4. In the Payment Modal:
   - Enter **Paid Amount** (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞)
   - Select **Payment Method** (‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô)
     - ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (Cash)
     - ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (Transfer)
   - Upload **Receipt** (optional)
   - Add **Notes** (optional)
5. Click "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô" (Record Payment)

**Success Message**: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß - ‡∏£‡∏≠ admin ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"
‚Üì Notification automatically sent to all Admins ‚Üì

---

### Pig Sale Payment Workflow

#### Step 1: Record Payment
1. Navigate to `/pig_sales` (‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏´‡∏°‡∏π)
2. Find a Pig Sale Record
3. Click Payment Button (üí∞ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô) 
4. In the Payment Modal:
   - Enter **Paid Amount** (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞)
   - Select **Payment Method** (‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô)
   - Upload **Receipt** (optional)
   - Add **Notes** (optional)
5. Click "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô" (Record Payment)

**Success Message**: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - ‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß X ‡∏ö‡∏≤‡∏ó (‡∏£‡∏≠ admin ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥)"
‚Üì Notification automatically sent to all Admins ‚Üì

---

## ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin Users (For Admin Users)

### Access Payment Approvals

#### Method 1: Direct URL
```
http://yoursite.com/payment_approvals
```

#### Method 2: Sidebar Menu
```
Left Sidebar ‚Üí "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô" (Payment Approvals)
```

#### Method 3: From Notification
```
Notification Bell ‚Üí Click payment notification ‚Üí Go to details
```

---

### Payment Approval Interface

#### Main Page View

**Three Tabs Available:**

| Tab | Status | Count | Action |
|-----|--------|-------|--------|
| ‚è≥ ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ | Pending | 15 | View & Approve/Reject |
| ‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß | Approved | 8 | View Only |
| ‚ùå ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÅ‡∏•‡πâ‡∏ß | Rejected | 2 | View Only |

---

### Approve Payment

#### Step 1: Review Pending Payments
1. Go to `/payment_approvals`
2. Click **"‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"** tab (should be active by default)
3. Review the list of pending payments

#### Step 2: View Details
1. Click **"‡∏î‡∏π"** button (Eye icon) to view full details

**Details Include:**
- Payment Type (Pig Entry or Pig Sale)
- Farm Name
- Batch Code
- Payment Date
- Quantity & Weight
- Payment Amount
- Total Balance

#### Step 3: Approve Payment
1. Click **"‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"** button (Green checkmark)
2. In Modal:
   - (Optional) Add approval notes
3. Click **"‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"** button in modal

**Result:**
- ‚úÖ Notification status changed to "approved"
- ‚úÖ Message shows "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß"
- ‚úÖ Moved to "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß" tab

---

### Reject Payment

#### Step 1: Review Payment
1. Go to `/payment_approvals`
2. Click **"‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"** tab
3. Click **"‡∏î‡∏π"** button to review details

#### Step 2: Reject Payment
1. Click **"‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò"** button (Red X)
2. In Modal:
   - Enter **Rejection Reason** (required) ‚ö†Ô∏è
   - Include specific reason for rejection
3. Click **"‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò"** button in modal

**Example Reasons:**
- "‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô"
- "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"
- "‡∏Ç‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"
- "‡∏£‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"

**Result:**
- ‚ùå Notification status changed to "rejected"
- ‚ùå Message shows "‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÅ‡∏•‡πâ‡∏ß"
- ‚ùå Moved to "‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÅ‡∏•‡πâ‡∏ß" tab
- Reason stored in database

---

### View Approval History

#### Approved Payments
1. Click **"‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß"** tab
2. View all previously approved payments
3. Click **"‡∏î‡∏π"** to see approval details
4. Includes approval notes (if added)

#### Rejected Payments
1. Click **"‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÅ‡∏•‡πâ‡∏ß"** tab
2. View all rejected payments
3. Click **"‡∏î‡∏π"** to see:
   - Rejection reason
   - Payment details
   - Original payment information

---

## üìä Status Indicators

### Color Coding

```
üü° Pending (‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥)
   - Status: In review
   - Action: Can approve/reject
   - Badge: Badge bg-warning

‚úÖ Approved (‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß)
   - Status: Completed
   - Action: View only
   - Badge: Badge bg-success

‚ùå Rejected (‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÅ‡∏•‡πâ‡∏ß)
   - Status: Rejected
   - Action: View only
   - Badge: Badge bg-danger
```

---

## üîç Filtering & Searching

### Tabs Filtering
- Click on tab to filter by status
- Count shows number of items in each tab
- Pagination available for each tab

### Sorting
- Default: Newest first (created_at desc)
- Click column headers to sort (if available)

### Pagination
- Shows 15 items per page
- Navigate using pagination controls
- Each tab has separate pagination

---

## üí° Tips & Best Practices

### For Users Recording Payments

‚úÖ **DO:**
- Upload clear receipt images
- Add descriptive notes if needed
- Double-check payment amount
- Use correct payment method

‚ùå **DON'T:**
- Leave required fields blank
- Upload blurry images
- Pay more than balance amount
- Mix payment amounts

### For Admins Approving

‚úÖ **DO:**
- Review details before approving
- Check receipt is clear
- Verify amounts match
- Add notes for clarity
- Reject if anything unclear

‚ùå **DON'T:**
- Approve without reviewing
- Skip verification steps
- Ignore discrepancies
- Leave reject reason blank

---

## ‚ö†Ô∏è Common Issues & Solutions

### Issue 1: Payment notification not appearing
**Solution:**
1. Verify user has 'admin' role
2. Check notification record in database
3. Refresh browser
4. Check notification settings

### Issue 2: Cannot approve/reject
**Solution:**
1. Verify you are logged in as Admin
2. Check user has proper role
3. Clear browser cache
4. Try different browser

### Issue 3: Amount exceeds balance
**Solution:**
1. Check remaining balance
2. Enter amount ‚â§ balance
3. Contact Finance for clarification

### Issue 4: File upload fails
**Solution:**
1. Check file size < 5MB
2. Use supported formats: JPG, PNG, PDF
3. Try uploading different file
4. Check internet connection

---

## üìã Checklist for Complete Payment Flow

### Recording Payment
- [ ] Navigate to correct record (Pig Entry or Sale)
- [ ] Click Payment button
- [ ] Enter paid amount
- [ ] Select payment method
- [ ] (Optional) Upload receipt
- [ ] (Optional) Add notes
- [ ] Click "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å" button
- [ ] See success message
- [ ] Notification sent to Admin

### Admin Approval
- [ ] Admin accesses `/payment_approvals`
- [ ] Reviews pending payments in first tab
- [ ] Clicks "‡∏î‡∏π" to see details
- [ ] Reviews all information
- [ ] Decides to approve or reject
- [ ] For approval: Click "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"
- [ ] For rejection: Click "‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò" + add reason
- [ ] Confirms in modal
- [ ] Payment status updated
- [ ] Tab updated automatically

---

## üéØ Key Information to Remember

| Item | Details |
|------|---------|
| **Access URL** | `/payment_approvals` |
| **Who can use** | Admin users only |
| **Default sort** | Newest first |
| **Items per page** | 15 |
| **Status options** | Pending, Approved, Rejected |
| **Required fields** | Paid amount, Payment method |
| **Optional fields** | Receipt, Notes |
| **Rejection required** | Rejection reason (mandatory) |
| **Approval notes** | Optional |

---

## üìû Support

### If you need help:

1. **Check this guide** - Look for similar issue
2. **Contact IT Team** - Report the problem
3. **Check Database** - Verify notification record
4. **Review Logs** - Check application logs

### Information to provide when reporting issues:
- Your username
- Payment ID (if available)
- Date and time of issue
- Error message (if any)
- Browser and OS information

---

**Last Updated**: October 21, 2025
**Version**: 1.0
